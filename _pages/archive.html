---
layout: default
title: "記事アーカイブ"
permalink: /archive/
---

<div class="archive-page">
    <div class="archive-header">
        <h1>記事アーカイブ</h1>
        <p>{{ site.title }}の全{{ site.posts.size }}記事をご覧いただけます</p>
    </div>
    
    <!-- Archive Statistics -->
    <div class="archive-stats">
        <div class="stat-card">
            <span class="stat-number">{{ site.posts.size }}</span>
            <span class="stat-label">総記事数</span>
        </div>
        <div class="stat-card">
            {% assign categories = site.posts | map: 'categories' | join: ',' | split: ',' | uniq %}
            <span class="stat-number">{{ categories.size }}</span>
            <span class="stat-label">カテゴリ数</span>
        </div>
        <div class="stat-card">
            {% assign tags = site.posts | map: 'tags' | join: ',' | split: ',' | uniq %}
            <span class="stat-number">{{ tags.size }}</span>
            <span class="stat-label">タグ数</span>
        </div>
        <div class="stat-card">
            {% assign authors = site.posts | map: 'author' | uniq %}
            <span class="stat-number">{{ authors.size }}</span>
            <span class="stat-label">執筆者数</span>
        </div>
    </div>
    
    <!-- Filter Controls -->
    <div class="archive-filters">
        <div class="filter-group">
            <label for="category-filter">カテゴリ:</label>
            <select id="category-filter" class="filter-select">
                <option value="">すべて</option>
                {% for category in site.content_categories %}
                <option value="{{ category.name }}">{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="filter-group">
            <label for="year-filter">年:</label>
            <select id="year-filter" class="filter-select">
                <option value="">すべて</option>
                {% assign years = site.posts | map: 'date' | map: 'year' | uniq | sort | reverse %}
                {% for year in years %}
                <option value="{{ year }}">{{ year }}年</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="filter-group">
            <label for="sort-filter">並び順:</label>
            <select id="sort-filter" class="filter-select">
                <option value="date-desc">新しい順</option>
                <option value="date-asc">古い順</option>
                <option value="title-asc">タイトル順</option>
            </select>
        </div>
        
        <button id="clear-filters" class="clear-filters-btn">フィルタをクリア</button>
    </div>
    
    <!-- Articles by Year -->
    <div class="archive-content">
        {% assign posts_by_year = site.posts | group_by_exp: 'post', 'post.date | date: "%Y"' %}
        {% for year in posts_by_year %}
        <div class="year-section" data-year="{{ year.name }}">
            <h2 class="year-title">{{ year.name }}年 ({{ year.items.size }}記事)</h2>
            
            {% assign posts_by_month = year.items | group_by_exp: 'post', 'post.date | date: "%Y-%m"' %}
            {% for month in posts_by_month %}
            <div class="month-section">
                <h3 class="month-title">{{ month.items.first.date | date: "%m月" }}</h3>
                
                <div class="articles-grid">
                    {% for post in month.items %}
                    <article class="archive-article" 
                             data-category="{{ post.categories | first | default: '' }}" 
                             data-year="{{ post.date | date: '%Y' }}"
                             data-title="{{ post.title }}"
                             data-date="{{ post.date | date: '%Y%m%d' }}">
                        <div class="article-date">
                            <span class="day">{{ post.date | date: "%-d" }}</span>
                            <span class="month">{{ post.date | date: "%b" }}</span>
                        </div>
                        
                        <div class="article-content">
                            <div class="article-meta">
                                {% if post.categories and post.categories.size > 0 %}
                                <span class="article-category">
                                    {% assign category = post.categories.first %}
                                    {% for cat in site.content_categories %}
                                        {% if cat.name == category %}
                                            {{ cat.icon }} {{ cat.name }}
                                        {% endif %}
                                    {% endfor %}
                                </span>
                                {% endif %}
                                {% if post.reading_time %}
                                <span class="reading-time">📖 {{ post.reading_time }}分</span>
                                {% endif %}
                            </div>
                            
                            <h3 class="article-title">
                                <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
                            </h3>
                            
                            {% if post.excerpt %}
                            <p class="article-excerpt">{{ post.excerpt | strip_html | truncate: 120 }}</p>
                            {% endif %}
                            
                            {% if post.tags and post.tags.size > 0 %}
                            <div class="article-tags">
                                {% for tag in post.tags limit:3 %}
                                <span class="tag">{{ tag }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </article>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    
    <!-- No Results Message -->
    <div id="no-results" class="no-results" style="display: none;">
        <h3>該当する記事がありません</h3>
        <p>フィルタ条件を変更してお試しください。</p>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const categoryFilter = document.getElementById('category-filter');
    const yearFilter = document.getElementById('year-filter');
    const sortFilter = document.getElementById('sort-filter');
    const clearFiltersBtn = document.getElementById('clear-filters');
    const articles = document.querySelectorAll('.archive-article');
    const yearSections = document.querySelectorAll('.year-section');
    const noResults = document.getElementById('no-results');
    
    function filterArticles() {
        const selectedCategory = categoryFilter.value;
        const selectedYear = yearFilter.value;
        let visibleCount = 0;
        
        // Hide all year sections first
        yearSections.forEach(section => {
            section.style.display = 'none';
        });
        
        articles.forEach(article => {
            const articleCategory = article.dataset.category;
            const articleYear = article.dataset.year;
            
            let show = true;
            
            if (selectedCategory && articleCategory !== selectedCategory) {
                show = false;
            }
            
            if (selectedYear && articleYear !== selectedYear) {
                show = false;
            }
            
            if (show) {
                article.style.display = 'block';
                // Show parent year section
                const yearSection = article.closest('.year-section');
                if (yearSection) {
                    yearSection.style.display = 'block';
                }
                visibleCount++;
            } else {
                article.style.display = 'none';
            }
        });
        
        // Hide empty month sections
        document.querySelectorAll('.month-section').forEach(monthSection => {
            const visibleArticles = monthSection.querySelectorAll('.archive-article[style="display: block;"], .archive-article:not([style*="display: none"])');
            if (visibleArticles.length === 0) {
                monthSection.style.display = 'none';
            } else {
                monthSection.style.display = 'block';
            }
        });
        
        // Show/hide no results message
        if (visibleCount === 0) {
            noResults.style.display = 'block';
        } else {
            noResults.style.display = 'none';
        }
    }
    
    function sortArticles() {
        const sortBy = sortFilter.value;
        const articlesArray = Array.from(articles);
        
        articlesArray.sort((a, b) => {
            switch (sortBy) {
                case 'date-desc':
                    return parseInt(b.dataset.date) - parseInt(a.dataset.date);
                case 'date-asc':
                    return parseInt(a.dataset.date) - parseInt(b.dataset.date);
                case 'title-asc':
                    return a.dataset.title.localeCompare(b.dataset.title);
                default:
                    return 0;
            }
        });
        
        // Re-arrange articles in DOM
        const container = document.querySelector('.archive-content');
        if (sortBy === 'date-desc') {
            // Restore original structure by year/month
            location.reload();
        } else {
            // Simple flat sorting for other options
            container.innerHTML = '';
            const sortedContainer = document.createElement('div');
            sortedContainer.className = 'sorted-articles-grid';
            articlesArray.forEach(article => {
                sortedContainer.appendChild(article.cloneNode(true));
            });
            container.appendChild(sortedContainer);
        }
    }
    
    // Event listeners
    categoryFilter.addEventListener('change', filterArticles);
    yearFilter.addEventListener('change', filterArticles);
    sortFilter.addEventListener('change', function() {
        if (this.value === 'date-desc') {
            filterArticles();
        } else {
            sortArticles();
            filterArticles();
        }
    });
    
    clearFiltersBtn.addEventListener('click', function() {
        categoryFilter.value = '';
        yearFilter.value = '';
        sortFilter.value = 'date-desc';
        
        articles.forEach(article => {
            article.style.display = 'block';
        });
        
        yearSections.forEach(section => {
            section.style.display = 'block';
        });
        
        document.querySelectorAll('.month-section').forEach(section => {
            section.style.display = 'block';
        });
        
        noResults.style.display = 'none';
        
        if (sortFilter.value === 'date-desc') {
            location.reload();
        }
    });
});
</script>

<style>
.archive-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

.archive-header {
    text-align: center;
    margin-bottom: 3rem;
}

.archive-header h1 {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--gray-900);
    margin-bottom: 1rem;
}

.archive-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
}

.stat-card {
    background: var(--white);
    padding: 2rem;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
    text-align: center;
    border: 1px solid var(--gray-200);
}

.stat-number {
    display: block;
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--primary-green);
    margin-bottom: 0.5rem;
}

.stat-label {
    color: var(--gray-600);
    font-size: 0.9rem;
    font-weight: 600;
}

.archive-filters {
    display: flex;
    gap: 2rem;
    margin-bottom: 3rem;
    padding: 2rem;
    background: var(--gray-50);
    border-radius: var(--border-radius-lg);
    flex-wrap: wrap;
    align-items: center;
}

.filter-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.filter-group label {
    font-weight: 600;
    color: var(--gray-700);
}

.filter-select {
    padding: 0.5rem;
    border: 1px solid var(--gray-300);
    border-radius: var(--border-radius);
    background: var(--white);
    color: var(--gray-700);
}

.clear-filters-btn {
    padding: 0.5rem 1rem;
    background: var(--primary-green);
    color: var(--white);
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-weight: 600;
}

.clear-filters-btn:hover {
    background: var(--primary-green-dark);
}

.year-section {
    margin-bottom: 3rem;
}

.year-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--gray-800);
    margin-bottom: 2rem;
    padding-bottom: 0.5rem;
    border-bottom: 3px solid var(--primary-green);
}

.month-section {
    margin-bottom: 2rem;
}

.month-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--gray-700);
    margin-bottom: 1.5rem;
}

.articles-grid {
    display: grid;
    gap: 1.5rem;
}

.archive-article {
    display: flex;
    background: var(--white);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
    overflow: hidden;
    border: 1px solid var(--gray-200);
    transition: all 0.2s ease;
}

.archive-article:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.article-date {
    background: var(--primary-green);
    color: var(--white);
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 80px;
    text-align: center;
}

.article-date .day {
    font-size: 1.5rem;
    font-weight: 800;
    line-height: 1;
}

.article-date .month {
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
}

.article-content {
    flex: 1;
    padding: 1.5rem;
}

.article-meta {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    flex-wrap: wrap;
}

.article-category {
    background: var(--gray-100);
    color: var(--gray-700);
    padding: 0.25rem 0.5rem;
    border-radius: var(--border-radius);
    font-size: 0.8rem;
    font-weight: 600;
}

.reading-time {
    color: var(--gray-600);
}

.article-title {
    margin-bottom: 1rem;
}

.article-title a {
    color: var(--gray-900);
    text-decoration: none;
    font-size: 1.2rem;
    font-weight: 700;
    line-height: 1.3;
}

.article-title a:hover {
    color: var(--primary-green);
}

.article-excerpt {
    color: var(--gray-600);
    line-height: 1.5;
    margin-bottom: 1rem;
}

.article-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.article-tags .tag {
    font-size: 0.8rem;
    padding: 0.2rem 0.5rem;
}

.sorted-articles-grid {
    display: grid;
    gap: 1.5rem;
}

.no-results {
    text-align: center;
    padding: 4rem 2rem;
    background: var(--gray-50);
    border-radius: var(--border-radius-lg);
    color: var(--gray-600);
}

@media (max-width: 768px) {
    .archive-filters {
        flex-direction: column;
        gap: 1rem;
    }
    
    .filter-group {
        width: 100%;
        justify-content: space-between;
    }
    
    .filter-select {
        flex: 1;
        max-width: 200px;
    }
    
    .archive-article {
        flex-direction: column;
    }
    
    .article-date {
        flex-direction: row;
        justify-content: center;
        gap: 1rem;
        padding: 1rem;
        min-width: auto;
    }
}
</style>